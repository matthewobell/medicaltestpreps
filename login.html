<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EMIGS Prep – Sign in</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Optional: reuse your main site CSS if you want it to look consistent -->
    <link rel="stylesheet" href="style.css">

    <!--
      This meta tag is for future use when the app is in the App Store.
      For now, it's harmless. Later you’ll replace YOUR_APP_STORE_ID with
      the real numeric ID.
    -->
    <meta name="apple-itunes-app" content="app-id=YOUR_APP_STORE_ID">

    <style>
        /* Simple inline styles so the page looks okay even without style.css */
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #F6EDD7;
            color: #222;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 40px 20px;
            text-align: center;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 16px;
        }

        p {
            font-size: 16px;
            line-height: 1.4;
            margin-bottom: 24px;
        }

        .button {
            display: inline-block;
            padding: 14px 24px;
            border-radius: 999px;
            background-color: #F4C869;
            color: #000;
            font-weight: 600;
            text-decoration: none;
            border: none;
            cursor: pointer;
        }

        .small {
            font-size: 13px;
            color: #555;
            margin-top: 16px;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Open EMIGS Prep</h1>
    <p>
        We’re opening your EMIGS Prep app to finish signing you in.
        If nothing happens, tap the button below.
    </p>

    <!-- This button’s link will be filled in by the script below -->
    <a id="openInApp" class="button" href="#">
        Open in EMIGS Prep
    </a>

    <p class="small" id="debugInfo"></p>
</div>

<script>
    (function () {
        // Take the query string from /login?mode=…&oobCode=…&apiKey=…
        var query = window.location.search || "";

        // This is the custom deep link that your app will eventually handle.
        // You’ll also need to define the "emigsprep" URL scheme in Xcode.
        var deepLink = "emigsprep://magic" + query;

        // Set the button href so the user can tap manually
        var btn = document.getElementById("openInApp");
        btn.setAttribute("href", deepLink);

        // Optional: show the deep link for debugging
        var debug = document.getElementById("debugInfo");
        debug.textContent = "Deep link: " + deepLink;

        // Try to auto-redirect after a short delay
        setTimeout(function () {
            window.location.href = deepLink;
        }, 800);
    })();
</script>
</body>
</html>
